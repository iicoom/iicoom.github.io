import{d as q,r as B,k as fe,c as M,w as H,o as ye,aL as ut,aM as dt,ab as Ze,f as i,q as be,aK as ze,X as Oe,Y as Be,z as Y,D as j,A as _e,v as W,F as we,E as O,S as Ue,J as je,B as le,L as Ie,aq as vt,G as Ae}from"./element-plus-40d2da59.js";import{G as ft,$ as mt,_ as He}from"./index-b38a4740.js";import{m as gt,a as ht,b as wt,c as pt,s as Ge,N as yt}from"./index-996c9a3b.js";import"./index-a1eee62b.js";import{c as oe,t as F,n as ae,s as J,v as qe,u as bt,b as re,x as $e,y as Je,z as Ct,A as kt,C as Ke,D as me,E as Ee,F as ie,G,w as ce,a as xt,m as de,H as St,L as Qe,J as De,K as Pt,M as et,d as Le,i as K,p as ve,P as _t,N as It,I as se,l as tt,r as Te,e as pe,f as Tt,O as Rt,Q as at,o as zt,R as ot,S as $t,g as Dt,T as Ot,U as Bt}from"./index-a22f7fa8.js";import{I as nt}from"./index-ba1c9571.js";import{C as Me,a as Fe}from"./index-3871dfeb.js";import{B as Re}from"./index-74c14a4e.js";import"./echarts-71ab4440.js";const[lt,ge]=oe("swipe"),Ut={loop:F,width:ae,height:ae,vertical:Boolean,autoplay:J(0),duration:J(500),touchable:F,lazyRender:Boolean,initialSwipe:J(0),indicatorColor:String,showIndicators:F,stopPropagation:F},it=Symbol(lt);var At=q({name:lt,props:Ut,emits:["change","dragStart","dragEnd"],setup(e,{emit:l,slots:r}){const t=B(),n=B(),a=fe({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let g=!1;const v=qe(),{children:w,linkChildren:h}=bt(it),o=M(()=>w.length),f=M(()=>a[e.vertical?"height":"width"]),y=M(()=>e.vertical?v.deltaY.value:v.deltaX.value),C=M(()=>a.rect?(e.vertical?a.rect.height:a.rect.width)-f.value*o.value:0),$=M(()=>f.value?Math.ceil(Math.abs(C.value)/f.value):o.value),R=M(()=>o.value*f.value),m=M(()=>(a.active+o.value)%o.value),T=M(()=>{const u=e.vertical?"vertical":"horizontal";return v.direction.value===u}),b=M(()=>{const u={transitionDuration:`${a.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${+a.offset.toFixed(2)}px)`};if(f.value){const I=e.vertical?"height":"width",z=e.vertical?"width":"height";u[I]=`${R.value}px`,u[z]=e[z]?`${e[z]}px`:""}return u}),d=u=>{const{active:I}=a;return u?e.loop?G(I+u,-1,o.value):G(I+u,0,$.value):I},P=(u,I=0)=>{let z=u*f.value;e.loop||(z=Math.min(z,-C.value));let Z=I-z;return e.loop||(Z=G(Z,C.value,0)),Z},S=({pace:u=0,offset:I=0,emitChange:z})=>{if(o.value<=1)return;const{active:Z}=a,V=d(u),ue=P(V,I);if(e.loop){if(w[0]&&ue!==C.value){const Ce=ue<C.value;w[0].setOffset(Ce?R.value:0)}if(w[o.value-1]&&ue!==0){const Ce=ue>0;w[o.value-1].setOffset(Ce?-R.value:0)}}a.active=V,a.offset=ue,z&&V!==Z&&l("change",m.value)},U=()=>{a.swiping=!0,a.active<=-1?S({pace:o.value}):a.active>=o.value&&S({pace:-o.value})},Q=()=>{U(),v.reset(),me(()=>{a.swiping=!1,S({pace:-1,emitChange:!0})})},c=()=>{U(),v.reset(),me(()=>{a.swiping=!1,S({pace:1,emitChange:!0})})};let k;const D=()=>clearTimeout(k),_=()=>{D(),+e.autoplay>0&&o.value>1&&(k=setTimeout(()=>{c(),_()},+e.autoplay))},E=(u=+e.initialSwipe)=>{if(!t.value)return;const I=()=>{var z,Z;if(!Ee(t)){const V={width:t.value.offsetWidth,height:t.value.offsetHeight};a.rect=V,a.width=+((z=e.width)!=null?z:V.width),a.height=+((Z=e.height)!=null?Z:V.height)}o.value&&(u=Math.min(o.value-1,u),u===-1&&(u=o.value-1)),a.active=u,a.swiping=!0,a.offset=P(u),w.forEach(V=>{V.setOffset(0)}),_()};Ee(t)?be().then(I):I()},X=()=>E(a.active);let ee;const te=u=>{!e.touchable||u.touches.length>1||(v.start(u),g=!1,ee=Date.now(),D(),U())},s=u=>{e.touchable&&a.swiping&&(v.move(u),T.value&&(!e.loop&&(a.active===0&&y.value>0||a.active===o.value-1&&y.value<0)||(ie(u,e.stopPropagation),S({offset:y.value}),g||(l("dragStart",{index:m.value}),g=!0))))},p=()=>{if(!e.touchable||!a.swiping)return;const u=Date.now()-ee,I=y.value/u;if((Math.abs(I)>.25||Math.abs(y.value)>f.value/2)&&T.value){const Z=e.vertical?v.offsetY.value:v.offsetX.value;let V=0;e.loop?V=Z>0?y.value>0?-1:1:0:V=-Math[y.value>0?"ceil":"floor"](y.value/f.value),S({pace:V,emitChange:!0})}else y.value&&S({pace:0});g=!1,a.swiping=!1,l("dragEnd",{index:m.value}),_()},x=(u,I={})=>{U(),v.reset(),me(()=>{let z;e.loop&&u===o.value?z=a.active===0?0:u:z=u%o.value,I.immediate?me(()=>{a.swiping=!1}):a.swiping=!1,S({pace:z-a.active,emitChange:!0})})},L=(u,I)=>{const z=I===m.value,Z=z?{backgroundColor:e.indicatorColor}:void 0;return i("i",{style:Z,class:ge("indicator",{active:z})},null)},N=()=>{if(r.indicator)return r.indicator({active:m.value,total:o.value});if(e.showIndicators&&o.value>1)return i("div",{class:ge("indicators",{vertical:e.vertical})},[Array(o.value).fill("").map(L)])};return re({prev:Q,next:c,state:a,resize:X,swipeTo:x}),h({size:f,props:e,count:o,activeIndicator:m}),H(()=>e.initialSwipe,u=>E(+u)),H(o,()=>E(a.active)),H(()=>e.autoplay,_),H([$e,Je,()=>e.width,()=>e.height],X),H(Ct(),u=>{u==="visible"?_():D()}),ye(E),ut(()=>E(a.active)),kt(()=>E(a.active)),dt(D),Ze(D),Ke("touchmove",s,{target:n}),()=>{var u;return i("div",{ref:t,class:ge()},[i("div",{ref:n,style:b.value,class:ge("track",{vertical:e.vertical}),onTouchstartPassive:te,onTouchend:p,onTouchcancel:p},[(u=r.default)==null?void 0:u.call(r)]),N()])}}});const Et=ce(At),[Lt,Mt]=oe("swipe-item");var Ft=q({name:Lt,setup(e,{slots:l}){let r;const t=fe({offset:0,inited:!1,mounted:!1}),{parent:n,index:a}=xt(it);if(!n)return;const g=M(()=>{const h={},{vertical:o}=n.props;return n.size.value&&(h[o?"height":"width"]=`${n.size.value}px`),t.offset&&(h.transform=`translate${o?"Y":"X"}(${t.offset}px)`),h}),v=M(()=>{const{loop:h,lazyRender:o}=n.props;if(!o||r)return!0;if(!t.mounted)return!1;const f=n.activeIndicator.value,y=n.count.value-1,C=f===0&&h?y:f-1,$=f===y&&h?0:f+1;return r=a.value===f||a.value===C||a.value===$,r}),w=h=>{t.offset=h};return ye(()=>{be(()=>{t.mounted=!0})}),re({setOffset:w}),()=>{var h;return i("div",{class:Mt(),style:g.value},[v.value?(h=l.default)==null?void 0:h.call(l):null])}}});const Yt=ce(Ft),Ye=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),Xt=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),ke=oe("image-preview")[1],Xe=2.6,Nt={src:String,show:Boolean,active:Number,minZoom:de(ae),maxZoom:de(ae),rootWidth:de(Number),rootHeight:de(Number),disableZoom:Boolean,doubleScale:Boolean,closeOnClickImage:Boolean,closeOnClickOverlay:Boolean,vertical:Boolean};var Vt=q({props:Nt,emits:["scale","close","longPress"],setup(e,{emit:l,slots:r}){const t=fe({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),n=qe(),a=B(),g=B(),v=B(!1),w=B(!1);let h=0;const o=M(()=>{const{scale:s,moveX:p,moveY:x,moving:L,zooming:N,initializing:u}=t,I={transitionDuration:N||L||u?"0s":".3s"};return(s!==1||w.value)&&(I.transform=`matrix(${s}, 0, 0, ${s}, ${p}, ${x})`),I}),f=M(()=>{if(t.imageRatio){const{rootWidth:s,rootHeight:p}=e,x=v.value?p/t.imageRatio:s;return Math.max(0,(t.scale*x-s)/2)}return 0}),y=M(()=>{if(t.imageRatio){const{rootWidth:s,rootHeight:p}=e,x=v.value?p:s*t.imageRatio;return Math.max(0,(t.scale*x-p)/2)}return 0}),C=(s,p)=>{var x;if(s=G(s,+e.minZoom,+e.maxZoom+1),s!==t.scale){const L=s/t.scale;if(t.scale=s,p){const N=De((x=a.value)==null?void 0:x.$el),u={x:N.width*.5,y:N.height*.5},I=t.moveX-(p.x-N.left-u.x)*(L-1),z=t.moveY-(p.y-N.top-u.y)*(L-1);t.moveX=G(I,-f.value,f.value),t.moveY=G(z,-y.value,y.value)}else t.moveX=0,t.moveY=w.value?h:0;l("scale",{scale:s,index:e.active})}},$=()=>{C(1)},R=()=>{const s=t.scale>1?1:2;C(s,s===2||w.value?{x:n.startX.value,y:n.startY.value}:void 0)};let m,T,b,d,P,S,U,Q,c=!1;const k=s=>{const{touches:p}=s;if(m=p.length,m===2&&e.disableZoom)return;const{offsetX:x}=n;n.start(s),T=t.moveX,b=t.moveY,Q=Date.now(),c=!1,t.moving=m===1&&(t.scale!==1||w.value),t.zooming=m===2&&!x.value,t.zooming&&(d=t.scale,P=Ye(p))},D=s=>{const{touches:p}=s;if(n.move(s),t.moving){const{deltaX:x,deltaY:L}=n,N=x.value+T,u=L.value+b;if((e.vertical?n.isVertical()&&Math.abs(u)>y.value:n.isHorizontal()&&Math.abs(N)>f.value)&&!c){t.moving=!1;return}c=!0,ie(s,!0),t.moveX=G(N,-f.value,f.value),t.moveY=G(u,-y.value,y.value)}if(t.zooming&&(ie(s,!0),p.length===2)){const x=Ye(p),L=d*x/P;S=Xt(p),C(L,S)}},_=s=>{var p;const x=(p=g.value)==null?void 0:p.$el;if(!x)return;const L=x.firstElementChild,N=s.target===x,u=L==null?void 0:L.contains(s.target);!e.closeOnClickImage&&u||!e.closeOnClickOverlay&&N||l("close")},E=s=>{if(m>1)return;const p=Date.now()-Q,x=250;n.isTap.value&&(p<x?e.doubleScale?U?(clearTimeout(U),U=null,R()):U=setTimeout(()=>{_(s),U=null},x):_(s):p>Pt&&l("longPress"))},X=s=>{let p=!1;if((t.moving||t.zooming)&&(p=!0,t.moving&&T===t.moveX&&b===t.moveY&&(p=!1),!s.touches.length)){t.zooming&&(t.moveX=G(t.moveX,-f.value,f.value),t.moveY=G(t.moveY,-y.value,y.value),t.zooming=!1),t.moving=!1,T=0,b=0,d=1,t.scale<1&&$();const x=+e.maxZoom;t.scale>x&&C(x,S)}ie(s,p),E(s),n.reset()},ee=()=>{const{rootWidth:s,rootHeight:p}=e,x=p/s,{imageRatio:L}=t;v.value=t.imageRatio>x&&L<Xe,w.value=t.imageRatio>x&&L>=Xe,w.value&&(h=(L*s-p)/2,t.moveY=h,t.initializing=!0,St(()=>{t.initializing=!1})),$()},te=s=>{const{naturalWidth:p,naturalHeight:x}=s.target;t.imageRatio=x/p,ee()};return H(()=>e.active,$),H(()=>e.show,s=>{s||$()}),H(()=>[e.rootWidth,e.rootHeight],ee),Ke("touchmove",D,{target:M(()=>{var s;return(s=g.value)==null?void 0:s.$el})}),re({resetScale:$}),()=>{const s={loading:()=>i(Qe,{type:"spinner"},null)};return i(Yt,{ref:g,class:ke("swipe-item"),onTouchstartPassive:k,onTouchend:X,onTouchcancel:X},{default:()=>[r.image?i("div",{class:ke("image-wrap")},[r.image({src:e.src,onLoad:te,style:o.value})]):i(nt,{ref:a,src:e.src,fit:"contain",class:ke("image",{vertical:v.value}),style:o.value,onLoad:te},s)]})}}});const[Wt,ne]=oe("image-preview"),Zt=["show","teleport","transition","overlayStyle","closeOnPopstate"],jt={show:Boolean,loop:F,images:et(),minZoom:J(1/3),maxZoom:J(3),overlay:F,vertical:Boolean,closeable:Boolean,showIndex:F,className:Le,closeIcon:K("clear"),transition:String,beforeClose:Function,doubleScale:F,overlayClass:Le,overlayStyle:Object,swipeDuration:J(300),startPosition:J(0),showIndicators:Boolean,closeOnPopstate:F,closeOnClickImage:F,closeOnClickOverlay:F,closeIconPosition:K("top-right"),teleport:[String,Object]};var st=q({name:Wt,props:jt,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:l,slots:r}){const t=B(),n=B(),a=fe({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),g=()=>{if(t.value){const d=De(t.value.$el);a.rootWidth=d.width,a.rootHeight=d.height,t.value.resize()}},v=d=>l("scale",d),w=d=>l("update:show",d),h=()=>{tt(e.beforeClose,{args:[a.active],done:()=>w(!1)})},o=d=>{d!==a.active&&(a.active=d,l("change",d))},f=()=>{if(e.showIndex)return i("div",{class:ne("index")},[r.index?r.index({index:a.active}):`${a.active+1} / ${e.images.length}`])},y=()=>{if(r.cover)return i("div",{class:ne("cover")},[r.cover()])},C=()=>{a.disableZoom=!0},$=()=>{a.disableZoom=!1},R=()=>i(Et,{ref:t,lazyRender:!0,loop:e.loop,class:ne("swipe"),vertical:e.vertical,duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:o,onDragEnd:$,onDragStart:C},{default:()=>[e.images.map((d,P)=>i(Vt,{ref:S=>{P===a.active&&(n.value=S)},src:d,show:e.show,active:a.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:a.rootWidth,rootHeight:a.rootHeight,disableZoom:a.disableZoom,doubleScale:e.doubleScale,closeOnClickImage:e.closeOnClickImage,closeOnClickOverlay:e.closeOnClickOverlay,vertical:e.vertical,onScale:v,onClose:h,onLongPress:()=>l("longPress",{index:P})},{image:r.image}))]}),m=()=>{if(e.closeable)return i(se,{role:"button",name:e.closeIcon,class:[ne("close-icon",e.closeIconPosition),It],onClick:h},null)},T=()=>l("closed"),b=(d,P)=>{var S;return(S=t.value)==null?void 0:S.swipeTo(d,P)};return re({resetScale:()=>{var d;(d=n.value)==null||d.resetScale()},swipeTo:b}),ye(g),H([$e,Je],g),H(()=>e.startPosition,d=>o(+d)),H(()=>e.show,d=>{const{images:P,startPosition:S}=e;d?(o(+S),be(()=>{g(),b(+S,{immediate:!0})})):l("close",{index:a.active,url:P[a.active]})}),()=>i(_t,ze({class:[ne(),e.className],overlayClass:[ne("overlay"),e.overlayClass],onClosed:T,"onUpdate:show":w},ve(e,Zt)),{default:()=>[m(),R(),f(),y()]})}});let he;const Ht={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,vertical:!1,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,doubleScale:!0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function Gt(){({instance:he}=gt({setup(){const{state:e,toggle:l}=ht(),r=()=>{e.images=[]};return()=>i(st,ze(e,{onClosed:r,"onUpdate:show":l}),null)}}))}const qt=(e,l=0)=>{if(Te)return he||Gt(),e=Array.isArray(e)?{images:e,startPosition:l}:e,he.open(pe({},Ht,e)),he};ce(st);const[Jt,xe]=oe("progress"),Kt={color:String,inactive:Boolean,pivotText:String,textColor:String,showPivot:F,pivotColor:String,trackColor:String,strokeWidth:ae,percentage:{type:ae,default:0,validator:e=>+e>=0&&+e<=100}};var Qt=q({name:Jt,props:Kt,setup(e){const l=M(()=>e.inactive?void 0:e.color),r=()=>{const{textColor:t,pivotText:n,pivotColor:a,percentage:g}=e,v=n??`${g}%`;if(e.showPivot&&v){const w={color:t,left:`${+g}%`,transform:`translate(-${+g}%,-50%)`,background:a||l.value};return i("span",{style:w,class:xe("pivot",{inactive:e.inactive})},[v])}};return()=>{const{trackColor:t,percentage:n,strokeWidth:a}=e,g={background:t,height:Tt(a)},v={width:`${n}%`,background:l.value};return i("div",{class:xe(),style:g},[i("span",{class:xe("portion",{inactive:e.inactive}),style:v},null),r()])}}});const ea=ce(Qt),[ta,Se,Ne]=oe("signature"),aa={tips:String,type:K("png"),penColor:K("#000"),lineWidth:Rt(3),clearButtonText:String,backgroundColor:K(""),confirmButtonText:String},oa=()=>{var e;const l=document.createElement("canvas");return!!((e=l.getContext)!=null&&e.call(l,"2d"))};var na=q({name:ta,props:aa,emits:["submit","clear","start","end","signing"],setup(e,{emit:l}){const r=B(),t=B(),n=M(()=>r.value?r.value.getContext("2d"):null),a=Te?oa():!0;let g=0,v=0,w;const h=()=>{if(!n.value)return!1;n.value.beginPath(),n.value.lineWidth=e.lineWidth,n.value.strokeStyle=e.penColor,w=De(r),l("start")},o=b=>{if(!n.value)return!1;ie(b);const d=b.touches[0],P=d.clientX-((w==null?void 0:w.left)||0),S=d.clientY-((w==null?void 0:w.top)||0);n.value.lineCap="round",n.value.lineJoin="round",n.value.lineTo(P,S),n.value.stroke(),l("signing",b)},f=b=>{ie(b),l("end")},y=b=>{const d=document.createElement("canvas");if(d.width=b.width,d.height=b.height,e.backgroundColor){const P=d.getContext("2d");C(P)}return b.toDataURL()===d.toDataURL()},C=b=>{b&&e.backgroundColor&&(b.fillStyle=e.backgroundColor,b.fillRect(0,0,g,v))},$=()=>{var b,d;const P=r.value;if(!P)return;const U=y(P)?"":((d=(b={jpg:()=>P.toDataURL("image/jpeg",.8),jpeg:()=>P.toDataURL("image/jpeg",.8)})[e.type])==null?void 0:d.call(b))||P.toDataURL(`image/${e.type}`);l("submit",{image:U,canvas:P})},R=()=>{n.value&&(n.value.clearRect(0,0,g,v),n.value.closePath(),C(n.value)),l("clear")},m=()=>{var b,d,P;if(a&&r.value){const S=r.value,U=Te?window.devicePixelRatio:1;g=S.width=(((b=t.value)==null?void 0:b.offsetWidth)||0)*U,v=S.height=(((d=t.value)==null?void 0:d.offsetHeight)||0)*U,(P=n.value)==null||P.scale(U,U),C(n.value)}},T=()=>{if(n.value){const b=n.value.getImageData(0,0,g,v);m(),n.value.putImageData(b,0,0)}};return H($e,T),ye(m),re({resize:T,clear:R,submit:$}),()=>i("div",{class:Se()},[i("div",{class:Se("content"),ref:t},[a?i("canvas",{ref:r,onTouchstartPassive:h,onTouchmove:o,onTouchend:f},null):i("p",null,[e.tips])]),i("div",{class:Se("footer")},[i(Re,{size:"small",onClick:R},{default:()=>[e.clearButtonText||Ne("clear")]}),i(Re,{type:"primary",size:"small",onClick:$},{default:()=>[e.confirmButtonText||Ne("confirm")]})])])}});const la=ce(na),[ia,A,sa]=oe("uploader");function Ve(e,l){return new Promise(r=>{if(l==="file"){r();return}const t=new FileReader;t.onload=n=>{r(n.target.result)},l==="dataUrl"?t.readAsDataURL(e):l==="text"&&t.readAsText(e)})}function rt(e,l){return at(e).some(r=>r.file?zt(l)?l(r.file):r.file.size>+l:!1)}function ra(e,l){const r=[],t=[];return e.forEach(n=>{rt(n,l)?t.push(n):r.push(n)}),{valid:r,invalid:t}}const ca=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,ua=e=>ca.test(e);function ct(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?ua(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var da=q({props:{name:ae,item:de(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:l,slots:r}){const t=()=>{const{status:o,message:f}=e.item;if(o==="uploading"||o==="failed"){const y=o==="failed"?i(se,{name:"close",class:A("mask-icon")},null):i(Qe,{class:A("loading")},null),C=$t(f)&&f!=="";return i("div",{class:A("mask")},[y,C&&i("div",{class:A("mask-message")},[f])])}},n=o=>{const{name:f,item:y,index:C,beforeDelete:$}=e;o.stopPropagation(),tt($,{args:[y,{name:f,index:C}],done:()=>l("delete")})},a=()=>l("preview"),g=()=>l("reupload"),v=()=>{if(e.deletable&&e.item.status!=="uploading"){const o=r["preview-delete"];return i("div",{role:"button",class:A("preview-delete",{shadow:!o}),tabindex:0,"aria-label":sa("delete"),onClick:n},[o?o():i(se,{name:"cross",class:A("preview-delete-icon")},null)])}},w=()=>{if(r["preview-cover"]){const{index:o,item:f}=e;return i("div",{class:A("preview-cover")},[r["preview-cover"](pe({index:o},f))])}},h=()=>{const{item:o,lazyLoad:f,imageFit:y,previewSize:C,reupload:$}=e;return ct(o)?i(nt,{fit:y,src:o.objectUrl||o.content||o.url,class:A("preview-image"),width:Array.isArray(C)?C[0]:C,height:Array.isArray(C)?C[1]:C,lazyLoad:f,onClick:$?g:a},{default:w}):i("div",{class:A("file"),style:ot(e.previewSize)},[i(se,{class:A("file-icon"),name:"description"},null),i("div",{class:[A("file-name"),"van-ellipsis"]},[o.file?o.file.name:o.url]),w()])};return()=>i("div",{class:A("preview")},[h(),t(),v()])}});const va={name:J(""),accept:K("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:J(1/0),imageFit:K("cover"),resultType:K("dataUrl"),uploadIcon:K("photograph"),uploadText:String,deletable:F,reupload:Boolean,afterRead:Function,showUpload:F,modelValue:et(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:F,previewOptions:Object,previewFullImage:F,maxSize:{type:[Number,String,Function],default:1/0}};var fa=q({name:ia,props:va,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:l,slots:r}){const t=B(),n=[],a=B(-1),g=B(!1),v=(c=e.modelValue.length)=>({name:e.name,index:c}),w=()=>{t.value&&(t.value.value="")},h=c=>{if(w(),rt(c,e.maxSize))if(Array.isArray(c)){const k=ra(c,e.maxSize);if(c=k.valid,l("oversize",k.invalid,v()),!c.length)return}else{l("oversize",c,v());return}if(c=fe(c),a.value>-1){const k=[...e.modelValue];k.splice(a.value,1,c),l("update:modelValue",k),a.value=-1}else l("update:modelValue",[...e.modelValue,...at(c)]);e.afterRead&&e.afterRead(c,v())},o=c=>{const{maxCount:k,modelValue:D,resultType:_}=e;if(Array.isArray(c)){const E=+k-D.length;c.length>E&&(c=c.slice(0,E)),Promise.all(c.map(X=>Ve(X,_))).then(X=>{const ee=c.map((te,s)=>{const p={file:te,status:"",message:"",objectUrl:URL.createObjectURL(te)};return X[s]&&(p.content=X[s]),p});h(ee)})}else Ve(c,_).then(E=>{const X={file:c,status:"",message:"",objectUrl:URL.createObjectURL(c)};E&&(X.content=E),h(X)})},f=c=>{const{files:k}=c.target;if(e.disabled||!k||!k.length)return;const D=k.length===1?k[0]:[].slice.call(k);if(e.beforeRead){const _=e.beforeRead(D,v());if(!_){w();return}if(Ot(_)){_.then(E=>{o(E||D)}).catch(w);return}}o(D)};let y;const C=()=>l("closePreview"),$=c=>{if(e.previewFullImage){const k=e.modelValue.filter(ct),D=k.map(_=>(_.objectUrl&&!_.url&&_.status!=="failed"&&(_.url=_.objectUrl,n.push(_.url)),_.url)).filter(Boolean);y=qt(pe({images:D,startPosition:k.indexOf(c),onClose:C},e.previewOptions))}},R=()=>{y&&y.close()},m=(c,k)=>{const D=e.modelValue.slice(0);D.splice(k,1),l("update:modelValue",D),l("delete",c,v(k))},T=c=>{g.value=!0,a.value=c,be(()=>Q())},b=()=>{g.value||(a.value=-1),g.value=!1},d=(c,k)=>{const D=["imageFit","deletable","reupload","previewSize","beforeDelete"],_=pe(ve(e,D),ve(c,D,!0));return i(da,ze({item:c,index:k,onClick:()=>l(e.reupload?"clickReupload":"clickPreview",c,v(k)),onDelete:()=>m(c,k),onPreview:()=>$(c),onReupload:()=>T(k)},ve(e,["name","lazyLoad"]),_),ve(r,["preview-cover","preview-delete"]))},P=()=>{if(e.previewImage)return e.modelValue.map(d)},S=c=>l("clickUpload",c),U=()=>{const c=e.modelValue.length<+e.maxCount,k=e.readonly?null:i("input",{ref:t,type:"file",class:A("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&a.value===-1,disabled:e.disabled,onChange:f,onClick:b},null);return r.default?Oe(i("div",{class:A("input-wrapper"),onClick:S},[r.default(),k]),[[Be,c]]):Oe(i("div",{class:A("upload",{readonly:e.readonly}),style:ot(e.previewSize),onClick:S},[i(se,{name:e.uploadIcon,class:A("upload-icon")},null),e.uploadText&&i("span",{class:A("upload-text")},[e.uploadText]),k]),[[Be,e.showUpload&&c]])},Q=()=>{t.value&&!e.disabled&&t.value.click()};return Ze(()=>{n.forEach(c=>URL.revokeObjectURL(c))}),re({chooseFile:Q,reuploadFile:T,closeImagePreview:R}),Dt(()=>e.modelValue),()=>i("div",{class:A()},[i("div",{class:A("wrapper",{disabled:e.disabled})},[P(),U()])])}});const Pe=ce(fa),ma="/spa/static/png/id-front-0b07afdc.png",ga="/spa/static/png/id-back-b4de95c2.png",ha="/spa/static/png/library-f9ede374.png",wa="/spa/static/png/camera-45ea48fc.png",pa={style:{padding:"15px"}},ya={class:"card-wrapper"},ba={class:"top"},Ca={key:0},ka=["src"],xa={key:1,src:ma,alt:"id-front"},Sa={key:1},Pa=["src"],_a={key:1,src:ga,alt:"id-back"},Ia={class:"upload-button"},Ta={class:"child"},Ra={class:"child"},za=q({__name:"SuperUploader",props:{showType:{type:String,required:!0,default:"pic"},side:{type:String,default:"front"},picProp:{type:String,default:""},maxCount:{type:Number,default:1},maxSize:{type:Number,default:1024*1024*5},accept:{type:String,default:"image/*"}},emits:["result","remove"],setup(e,{expose:l,emit:r}){const t=e,n=r,a={front:"拍摄正面",back:"拍摄背面"},g=B([]),v=B(!1),w=()=>{v.value=!0},h=B(),o=B(),f=async R=>{v.value=!1,wt({message:"上传中...",forbidClick:!0,duration:0});const m=new FormData,{blob:T}=await ft.compressImage(R.file,.6);m.append("file",T,"compressed_image.png");const b={"Content-Type":"multipart/form-data"},d=await mt.sendRequest("UploadFile",m,b);pt(),d&&d.url?(t.side=="front"&&(h.value=d.url),t.side=="back"&&(o.value=d.url),n("result",d.url,t.picProp,t.maxCount)):(g.value[0].status="failed",g.value[0].message="上传失败")},y=R=>{n("remove",R.url,t.picProp,t.maxCount)},C=()=>{Ge("文件大小不能超过 5M")};return l({init:R=>{if(t.showType==="idcard"&&(t.side=="back"&&(o.value=R),t.side=="front"&&(h.value=R)),t.showType==="pic")if(t.maxCount>1){const m=JSON.parse(R);g.value=m.map(T=>({url:T,status:"done",message:""}))}else g.value=[{url:R,status:"done",message:""}]}}),(R,m)=>(Y(),j("div",pa,[e.showType==="pic"?(Y(),_e(W(Pe),{key:0,modelValue:g.value,"onUpdate:modelValue":m[0]||(m[0]=T=>g.value=T),"max-count":e.maxCount,"max-size":e.maxSize,"after-read":f,onOversize:C,onDelete:y},null,8,["modelValue","max-count","max-size"])):e.showType==="idcard"?(Y(),j(we,{key:1},[O("div",ya,[O("div",ba,[e.side==="front"?(Y(),j("div",Ca,[h.value?(Y(),j("img",{key:0,src:h.value,alt:"id-front"},null,8,ka)):(Y(),j("img",xa))])):Ue("",!0),e.side==="back"?(Y(),j("div",Sa,[o.value?(Y(),j("img",{key:0,src:o.value,alt:"id-back"},null,8,Pa)):(Y(),j("img",_a))])):Ue("",!0)]),O("div",{class:"button",onClick:w},je(a[e.side]),1)]),i(W(Bt),{show:v.value,"z-index":"100",onClick:m[3]||(m[3]=T=>v.value=!1)},{default:le(()=>[O("div",{class:"overlay-inner-wrapper",onClick:m[2]||(m[2]=vt(()=>{},["stop"]))},[m[8]||(m[8]=O("h4",null,"选择文件上传的方式",-1)),i(W(se),{name:"cross",class:"close",onClick:m[1]||(m[1]=T=>v.value=!1)}),O("div",Ia,[O("div",Ta,[i(W(Pe),{"after-read":f},{default:le(()=>m[4]||(m[4]=[O("img",{src:ha,alt:"library"},null,-1)])),_:1}),m[5]||(m[5]=O("p",null,"选择文件",-1))]),O("div",Ra,[i(W(Pe),{capture:"camera","after-read":f},{default:le(()=>m[6]||(m[6]=[O("img",{src:wa,alt:"camera"},null,-1)])),_:1}),m[7]||(m[7]=O("p",null,"拍照上传",-1))])])])]),_:1},8,["show"])],64)):(Y(),j(we,{key:2},[Ie(" TODO more... ")],64))]))}});const We=He(za,[["__scopeId","data-v-7f3a3068"]]),$a={class:"wrapper"},Da={class:"progress-wrapper"},Oa={class:"progress-label"},Ba={class:"signature"},Ua={style:{"background-color":"#fff"}},Aa={class:"bottom"},Ea=q({__name:"government",setup(e){const l=()=>history.back(),r=B(["请选择公安机关","请选择公安机关","请选择公安机关","请选择公安机关","请选择公安机关","请选择公安机关"]),t=B(1),n=()=>{t.value<6&&t.value++},a=B(""),g=w=>{a.value=w.image},v=()=>Ge("clear");return(w,h)=>(Y(),j("div",$a,[i(W(yt),{title:"标题","left-text":"返回","left-arrow":"",fixed:"","safe-area-inset-top":"",onClickLeft:l}),O("div",Da,[O("div",Oa,[h[1]||(h[1]=O("span",null,"填写信息",-1)),O("span",null,[O("strong",null,je(t.value),1),h[0]||(h[0]=Ie("/6"))])]),i(W(ea),{percentage:Math.round(t.value/6*100),"stroke-width":"5",color:"#2f63c4","show-pivot":!1},null,8,["percentage"])]),i(W(Fe),{title:"分组1"},{default:le(()=>[(Y(!0),j(we,null,Ae(r.value,o=>(Y(),_e(W(Me),{key:o,title:o,"is-link":""},null,8,["title"]))),128))]),_:1}),i(W(Fe),{title:"分组2"},{default:le(()=>[(Y(!0),j(we,null,Ae(r.value,o=>(Y(),_e(W(Me),{key:o,title:o},null,8,["title"]))),128))]),_:1}),O("div",Ba,[i(W(la),{onSubmit:g,onClear:v})]),O("div",Ua,[i(We,{"show-type":"idcard"}),i(We)]),O("div",Aa,[i(W(Re),{type:"primary",block:"",size:"normal",onClick:n},{default:le(()=>h[2]||(h[2]=[Ie("下一步")])),_:1})])]))}});const ja=He(Ea,[["__scopeId","data-v-864ac19a"]]);export{ja as default};
