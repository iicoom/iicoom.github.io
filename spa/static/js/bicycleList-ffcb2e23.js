import{$ as p,a as I,G as S,_ as M}from"./index-b38a4740.js";import{G as N}from"./index-200d4584.js";import{G as J}from"./index-eea43a08.js";import{k as z,d as h,r as s,o as O,z as j,D as A,E as _,f as o,v as r,B as n,C as u,L as l,aI as H,as as K,J as b,aw as Q,ap as W,a7 as x}from"./element-plus-40d2da59.js";import"./echarts-71ab4440.js";const X=z([{label:"品牌名称",prop:"title"},{label:"图片",prop:"pic",tdSlot:"pic"},{label:"价格",prop:"price"},{label:"商家",prop:"merchant"},{label:"类型",prop:"merchant_type",tdSlot:"merchant_type"},{label:"创建时间",prop:"create_time",tdSlot:"createTime",width:"200px",align:"center"},{label:"更新时间",prop:"update_time",tdSlot:"updateTime",width:"200px",align:"center"},{label:"操作",prop:"operate",tdSlot:"operate",align:"center",fixed:"right",width:"280px"}]),Y=z([{field:"title",type:"input",label:"名称"},{field:"type",type:"select",label:"类型",options:[{label:"电动车",value:1},{label:"电池",value:2}]}]),Z={class:"page-container"},ee={class:"tool-bar"},te={class:"image-slot"},ae=h({__name:"bicycleList",setup(oe){const w=s(),d=s(),c=s(!1),m=s(""),f=s("{8: [50, 100]}");O(()=>{g()});function C(){d.value.pagination.page=1,g()}const B=s([]),y=s(!1);async function g(){y.value=!0;const a={...w.value.formFieldsValue,page:d.value.pagination.page,size:d.value.pagination.size},e=await p.sendRequest("GetBicycleList",a);B.value=e.list,d.value.pagination.total=e.total,y.value=!1}const v=I(),G=()=>{v.push({name:"BicycleInfo",params:{id:0}})},$=a=>{v.push({name:"BicycleInfo",params:{id:a._id}})},q=a=>{v.push({name:"PageDetail",query:{id:a.id,copy:1}})},D=()=>{c.value=!0,k("banner.txt"),k("coupon.txt")},L=a=>{W.confirm(`确定要删除 【${a.title}】？`,"Tips",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{await p.sendRequest("DeleteBicycle",{id:a._id}),x.success("删除成功"),g()}).catch(e=>{console.error(e),x({type:"info",message:"取消删除"})})},k=async a=>{if(a==="banner.txt"){const e=await p.sendRequest("GetConfigByFileName",{filename:a});e&&(m.value=e)}if(a==="coupon.txt"){const e=await p.sendRequest("GetConfigByFileName",{filename:a});e&&(f.value=JSON.stringify(e))}},T=async a=>{a==="coupon.txt"&&await p.sendRequest("UpdateConfigByFileName",{filename:a,content:f.value}),a==="banner.txt"&&await p.sendRequest("UpdateConfigByFileName",{filename:a,content:m.value}),x.success("保存成功"),c.value=!1};return(a,e)=>{const i=u("el-button"),P=u("el-icon"),U=u("el-image"),V=u("el-divider"),R=u("el-input"),E=u("el-dialog");return j(),A("div",Z,[_("div",ee,[o(J,{ref_key:"gtfRef",ref:w,"form-fields":r(Y),onTableFilter:C},null,8,["form-fields"]),_("div",null,[o(i,{type:"primary",icon:r(H),onClick:D},{default:n(()=>e[5]||(e[5]=[l("配置")])),_:1},8,["icon"]),o(i,{type:"primary",icon:r(K),onClick:G},{default:n(()=>e[6]||(e[6]=[l("新增")])),_:1},8,["icon"])])]),o(N,{ref_key:"gtRef",ref:d,loading:y.value,columns:r(X),tableData:B.value,onPageChange:g,onSizeChange:C},{merchant_type:n(t=>[l(b(t.row.type==1?"电动车":"电池"),1)]),pic:n(t=>[o(U,{style:{width:"60px",height:"60px","line-height":"60px"},src:t.row.pic,"preview-src-list":[t.row.pic],"preview-teleported":"",fit:"contain"},{error:n(()=>[_("div",te,[o(P,null,{default:n(()=>[o(r(Q))]),_:1})])]),_:2},1032,["src","preview-src-list"])]),createTime:n(t=>[l(b(r(S).formatTime(t.row.create_time)),1)]),updateTime:n(t=>[l(b(r(S).formatTime(t.row.update_time)),1)]),operate:n(t=>[o(i,{size:"small",type:"primary",onClick:F=>$(t.row)},{default:n(()=>e[7]||(e[7]=[l("编辑")])),_:2},1032,["onClick"]),o(i,{size:"small",type:"primary",onClick:F=>q(t.row)},{default:n(()=>e[8]||(e[8]=[l("复制")])),_:2},1032,["onClick"]),o(i,{size:"small",type:"danger",onClick:F=>L(t.row)},{default:n(()=>e[9]||(e[9]=[l("删除")])),_:2},1032,["onClick"])]),_:1},8,["loading","columns","tableData"]),o(E,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=t=>c.value=t),title:"配置",width:"800"},{default:n(()=>[o(V,{"content-position":"left"},{default:n(()=>e[10]||(e[10]=[l("首页banner")])),_:1}),o(i,{type:"primary",size:"mini",style:{"margin-bottom":"10px"},onClick:e[0]||(e[0]=t=>T("banner.txt"))},{default:n(()=>e[11]||(e[11]=[l("保存")])),_:1}),o(R,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=t=>m.value=t),type:"textarea"},null,8,["modelValue"]),o(V,{"content-position":"left"},{default:n(()=>e[12]||(e[12]=[l("商家优惠券范围")])),_:1}),o(i,{type:"primary",size:"mini",style:{"margin-bottom":"10px"},onClick:e[2]||(e[2]=t=>T("coupon.txt"))},{default:n(()=>e[13]||(e[13]=[l("保存")])),_:1}),o(R,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=t=>f.value=t),type:"textarea"},null,8,["modelValue"])]),_:1},8,["modelValue"])])}}});const pe=M(ae,[["__scopeId","data-v-fb693098"]]);export{pe as default};
