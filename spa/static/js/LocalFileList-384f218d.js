import{$ as g,G as b}from"./index-b38a4740.js";import{G as x}from"./index-200d4584.js";import{G as T}from"./index-eea43a08.js";import{k as _,d as C,r as i,o as k,z as F,D as G,E as y,f as l,v as d,B as n,C as z,L as r,J as B,ap as R,a7 as S}from"./element-plus-40d2da59.js";import"./echarts-71ab4440.js";const L=_([{label:"文件名称",prop:"name",width:"200px",showTooltip:!1},{label:"图标",prop:"icon",tdSlot:"icon",showTooltip:!1},{label:"文件类型",prop:"type",tdSlot:"type",width:"280px"},{label:"上传时间",prop:"create_time",tdSlot:"createTime",width:"200px",align:"center"},{label:"上传人",prop:"creator",width:"200px",align:"center"},{label:"操作",prop:"operate",tdSlot:"operate",fixed:"right",width:"220px",align:"center"}]),D=_([{field:"name",type:"input",label:"文件名"},{field:"type",type:"select",label:"文件类型"}]),$={class:"page-container"},E={class:"tool-bar"},V=["href","download"],j=C({__name:"LocalFileList",setup(M){const f=i(),p=i();k(()=>{s()});function m(){p.value.pagination.page=1,s()}const u=i([]),c=i(!1);async function s(){var o,t;c.value=!0;const a={...f.value.formFieldsValue,page:(o=p.value)==null?void 0:o.pagination.page,size:(t=p.value)==null?void 0:t.pagination.size},e=await g.sendRequest("GetUploads",a);u.value=e.list,c.value=!1}function h(a){R.confirm(`确定要删除【${a.name}】？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{console.log(a),await g.sendRequest("RemoveLocalFile",{filename:a.name})&&(S({type:"success",message:"操作成功"}),s())}).catch(()=>{})}function v(a){b.copyTextToClipboard(a.url)}return(a,e)=>{const o=z("el-button");return F(),G("div",$,[y("div",E,[l(T,{ref_key:"gtfRef",ref:f,"form-fields":d(D),onTableFilter:m},null,8,["form-fields"])]),l(x,{re:"",f:"gtRef",loading:c.value,columns:d(L),tableData:u.value,onPageChange:s,onSizeChange:m},{createTime:n(t=>[r(B(d(b).formatTime(t.row.create_time)),1)]),operate:n(t=>[y("a",{href:t.row.url,download:t.row.name||"default-name",target:"_blank"},[l(o,{type:"primary",size:"small",style:{"margin-right":"10px"}},{default:n(()=>e[0]||(e[0]=[r("下载")])),_:1})],8,V),l(o,{type:"primary",size:"small",onClick:w=>v(t.row)},{default:n(()=>e[1]||(e[1]=[r("复制链接")])),_:2},1032,["onClick"]),l(o,{type:"danger",size:"small",onClick:w=>h(t.row)},{default:n(()=>e[2]||(e[2]=[r("删除")])),_:2},1032,["onClick"])]),_:1},8,["loading","columns","tableData"])])}}});export{j as default};
