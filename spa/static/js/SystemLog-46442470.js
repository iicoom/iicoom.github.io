import{$ as b,G as y}from"./index-b38a4740.js";import{G as k}from"./index-200d4584.js";import{G}from"./index-eea43a08.js";import{k as T,d as R,r as n,o as F,z as v,D as L,E as w,f as i,B as a,v as p,C as x,A as N,L as r,S as V,J as d,ap as z,a7 as A}from"./element-plus-40d2da59.js";import"./echarts-71ab4440.js";const D=T([{label:"",prop:"",type:"selection"},{label:"IP",prop:"ip",width:"150px"},{label:"method",prop:"method"},{label:"url",prop:"url",width:"150px"},{label:"username",prop:"username",width:"150px"},{label:"statusCode",prop:"statusCode",width:"150px"},{label:"area",prop:"location",tdSlot:"location",width:"300px"},{label:"operation",prop:"operation",width:"200px",showTooltip:!1},{label:"userAgent",prop:"userAgent",width:"200px"},{label:"createTime",prop:"createTime",tdSlot:"createTime",width:"110px",fixed:"right",showTooltip:!1}]),E=T([{field:"name",type:"input",label:"用户名"}]),M={class:"page-container"},P={class:"tool-bar"},$={style:{display:"flex",gap:"5px"}},O=R({__name:"SystemLog",setup(q){const _=n(),o=n();F(()=>{f()});function m(){o.value.pagination.page=1,f()}const h=n([]),u=n(!1);async function f(){u.value=!0;const l={..._.value.formFieldsValue,page:o.value.pagination.page,size:o.value.pagination.size},t=await b.sendRequest("GetSystemLog",l);h.value=t.list,o.value.pagination.total=t.total,u.value=!1}const c=n([]),S=l=>{c.value=l.map(t=>t._id)},C=()=>{z.confirm(`确认要删除选中的 ${c.value.length} 条数据？`,"温馨提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{await b.sendRequest("BatchRemoveSystemLog",{ids:c.value})&&(A({type:"success",message:"操作成功"}),m())}).catch(()=>{})};return(l,t)=>{const B=x("el-button"),g=x("el-tag");return v(),L("div",M,[w("div",P,[i(G,{ref_key:"gtfRef",ref:_,"form-fields":p(E),onTableFilter:m},{btnAction:a(()=>[p(y).getPlatform()==="pc"?(v(),N(B,{key:0,type:"danger",disabled:!c.value.length,onClick:C},{default:a(()=>t[0]||(t[0]=[r(" 批量删除 ")])),_:1},8,["disabled"])):V("",!0)]),_:1},8,["form-fields"])]),i(k,{ref_key:"gtRef",ref:o,loading:u.value,columns:p(D),tableData:h.value,rowKey:"_id",onPageChange:f,onSizeChange:m,onSelectChange:S},{location:a(s=>[w("span",$,[i(g,{type:"primary"},{default:a(()=>{var e;return[r(d((e=s.row.location)==null?void 0:e.country),1)]}),_:2},1024),i(g,{type:"success"},{default:a(()=>{var e;return[r(d((e=s.row.location)==null?void 0:e.regionName),1)]}),_:2},1024),i(g,{type:"warning"},{default:a(()=>{var e;return[r(d((e=s.row.location)==null?void 0:e.city),1)]}),_:2},1024)])]),createTime:a(s=>[r(d(p(y).formatTime(s.row.create_time)),1)]),_:1},8,["loading","columns","tableData"])])}}});export{O as default};
