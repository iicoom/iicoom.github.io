import{$ as G,G as f}from"./index-842d9a02.js";import{G as k}from"./index-99d661d0.js";import{G as D}from"./index-0b9e988c.js";import{k as x,d as F,r as s,o as C,z as m,D as g,E as y,f as o,v as i,B as t,C as _,aA as A,F as L,G as R,L as l,J as a}from"./element-plus-40d2da59.js";import"./echarts-71ab4440.js";const z=x([{label:"用户",prop:"client",width:"150px",align:"center"},{label:"IP",prop:"ip",tdSlot:"ip",width:"150px",showTooltip:!1},{label:"地区",prop:"location",tdSlot:"location",width:"280px"},{label:"上线时间",prop:"create_time",tdSlot:"createTime",width:"200px",align:"center"},{label:"下线时间",prop:"update_time",tdSlot:"updateTime",width:"200px",align:"center"},{label:"连接时长",prop:"sessionDuration",tdSlot:"sessionDuration",fixed:"right",align:"center"}]),B=x([{field:"client",type:"input",label:"用户名"}]),N={class:"page-container"},V={class:"tool-bar"},E={style:{display:"flex",gap:"5px"}},I=F({__name:"ActiveLog",setup(M){const v=s(),n=s();C(()=>{p()});function w(){n.value.pagination.page=1,p()}const h=s([]),c=s(!1);async function p(){c.value=!0;const b={...v.value.formFieldsValue,page:n.value.pagination.page,size:n.value.pagination.size},d=await G.sendRequest("GetActiveLog",b);h.value=d.list,n.value.pagination.total=d.total,c.value=!1}return(b,d)=>{const r=_("el-tag"),T=_("el-link"),S=_("el-popover");return m(),g("div",N,[y("div",V,[o(D,{ref_key:"gtfRef",ref:v,"form-fields":i(B),onTableFilter:w},null,8,["form-fields"])]),o(k,{ref_key:"gtRef",ref:n,loading:c.value,columns:i(z),tableData:h.value,onPageChange:p,onSizeChange:w},{ip:t(e=>[o(S,{placement:"top",title:"位置信息",width:500,trigger:"hover"},A({reference:t(()=>[o(T,null,{default:t(()=>[l(a(e.row.ipAddress),1)]),_:2},1024)]),_:2},[e.row.location?{name:"default",fn:t(()=>[(m(!0),g(L,null,R(Object.keys(e.row.location),u=>(m(),g("div",{key:u,style:{"margin-top":"5px"}},[o(r,null,{default:t(()=>[l(a(u)+": "+a(e.row.location[u]),1)]),_:2},1024)]))),128))]),key:"0"}:void 0]),1024)]),location:t(e=>[y("span",E,[o(r,{type:"primary"},{default:t(()=>[l(a(e.row.location.country),1)]),_:2},1024),o(r,{type:"success"},{default:t(()=>[l(a(e.row.location.regionName),1)]),_:2},1024),o(r,{type:"warning"},{default:t(()=>[l(a(e.row.location.city),1)]),_:2},1024)])]),createTime:t(e=>[l(a(i(f).formatTime(e.row.create_time)),1)]),updateTime:t(e=>[l(a(i(f).formatTime(e.row.update_time)),1)]),sessionDuration:t(e=>[l(a(i(f).convertSecondsToHMS(e.row.sessionDuration)),1)]),_:1},8,["loading","columns","tableData"])])}}});export{I as default};
