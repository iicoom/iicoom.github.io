import{G as C,$ as T}from"./index-842d9a02.js";import{d as Q,r as u,o as W,k as Y,z as r,D as L,f as l,B as a,v as s,X as Z,A as m,C as o,al as ee,F as le,G as te,L as p,E as ae,aw as ne,ax as oe,ay as ie,J as $,S as D,ap as se,a7 as re,q as ue}from"./element-plus-40d2da59.js";import{A as pe,v as de}from"./AudioPlayer-010cca74.js";import"./echarts-71ab4440.js";const ce={class:"page-container"},me={class:"image-slot"},be=Q({__name:"FileList",setup(fe){const i={page:1,pages:0,limit:10,sizes:[10,20,50,100],total:0};function S(n){i.limit=n,_()}function G(n){i.page=n,_()}const x=u([]),h=[{label:"图片",value:1},{label:"音频",value:2},{label:"视频",value:3}],P=C.arr2map(h),v=u(!1),y=u(),z=u(),f=u();W(()=>{_()});const V=u();let d=Y({name:"",type:""});function R(){var n;(n=V.value)==null||n.resetFields(),F()}function F(){i.page=1,_()}const b=u(!1);async function _(){b.value=!0;const n={...d,page:i.page,limit:i.limit},t=await T.sendRequest("GetFileList",n);x.value=t.list,i.total=t.total,b.value=!1}function E(n){se.confirm(`确定要删除【${n.name}】？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{console.log(n),await T.sendRequest("RemoveFile",{id:n.id})&&(re({type:"success",message:"操作成功"}),_())}).catch(()=>{})}function M(n){C.copyTextToClipboard(n.url)}function N(n){v.value=!0,f.value=n.type,ue(()=>{f.value===2&&(y.value.init(n.url),y.value.handlePlayOrPause()),f.value===3&&z.value.init(n.url)})}function q(){v.value=!1}return(n,t)=>{const A=o("el-input"),k=o("el-form-item"),U=o("el-option"),j=o("el-select"),g=o("el-button"),J=o("el-form"),c=o("el-table-column"),w=o("el-icon"),O=o("el-image"),X=o("el-table"),H=o("el-pagination"),I=o("el-dialog"),K=ee("loading");return r(),L("div",ce,[l(J,{model:s(d),ref_key:"searchFormRef",ref:V,inline:"",style:{"text-align":"left","margin-top":"10px"}},{default:a(()=>[l(k,{label:"文件名称",prop:"name"},{default:a(()=>[l(A,{placeholder:"",modelValue:s(d).name,"onUpdate:modelValue":t[0]||(t[0]=e=>s(d).name=e),clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),l(k,{label:"文件类型",prop:"type"},{default:a(()=>[l(j,{modelValue:s(d).type,"onUpdate:modelValue":t[1]||(t[1]=e=>s(d).type=e),clearable:"",placeholder:""},{default:a(()=>[(r(),L(le,null,te(h,e=>l(U,{key:e.type,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),l(k,null,{default:a(()=>[l(g,{type:"primary",onClick:F},{default:a(()=>t[4]||(t[4]=[p("搜索")])),_:1}),l(g,{onClick:t[2]||(t[2]=e=>R())},{default:a(()=>t[5]||(t[5]=[p("重置")])),_:1})]),_:1})]),_:1},8,["model"]),Z((r(),m(X,{data:x.value,border:"",style:{width:"100%"}},{default:a(()=>[l(c,{prop:"name",label:"名称",align:"center"}),l(c,{align:"center",label:"图标"},{default:a(e=>[e.row.type===1?(r(),m(O,{key:0,style:{width:"60px",height:"60px","line-height":"60px"},src:e.row.url,"preview-src-list":[e.row.url],"preview-teleported":"",fit:"contain"},{error:a(()=>[ae("div",me,[l(w,null,{default:a(()=>[l(s(ne))]),_:1})])]),_:2},1032,["src","preview-src-list"])):e.row.type===2?(r(),m(w,{key:1,size:20},{default:a(()=>[l(s(oe))]),_:1})):(r(),m(w,{key:2,size:20},{default:a(()=>[l(s(ie))]),_:1}))]),_:1}),l(c,{align:"center",label:"文件类型"},{default:a(e=>[p($(s(P)[e.row.type]),1)]),_:1}),l(c,{prop:"uploader",label:"上传人",align:"center"}),l(c,{prop:"create_time",label:"上传时间",align:"center",width:"110"},{default:a(e=>[p($(s(C).formatTime(e.row.create_time)),1)]),_:1}),l(c,{align:"center",label:"操作",width:"220",fixed:"right"},{default:a(e=>[l(g,{type:"primary",size:"small",onClick:B=>M(e.row)},{default:a(()=>t[6]||(t[6]=[p("复制链接")])),_:2},1032,["onClick"]),l(g,{disabled:e.row.type===1,type:"primary",size:"small",onClick:B=>N(e.row)},{default:a(()=>t[7]||(t[7]=[p(" 预览 ")])),_:2},1032,["disabled","onClick"]),l(g,{type:"danger",size:"small",onClick:B=>E(e.row)},{default:a(()=>t[8]||(t[8]=[p("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,b.value]]),l(H,{layout:"total, sizes, prev, pager, next, jumper",onSizeChange:S,onCurrentChange:G,"current-page":i.page,"page-sizes":i.sizes,"page-size":i.limit,total:i.total},null,8,["current-page","page-sizes","page-size","total"]),l(I,{modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=e=>v.value=e),title:"预览",center:"","close-on-click-modal":!1,"destroy-on-close":"",width:"40%",onClose:q},{default:a(()=>[f.value===2?(r(),m(pe,{key:0,ref_key:"ap",ref:y},null,512)):D("",!0),f.value===3?(r(),m(de,{key:1,ref_key:"vp",ref:z},null,512)):D("",!0)]),_:1},8,["modelValue"])])}}});export{be as default};
